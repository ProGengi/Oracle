#
#
#
#
#

physical backup：
 备份数据文件，控制文件。。
logical backup：
 将表结构，行中的数据导出来。
 
 
Flashback ：
 flashback querry：用于检索之前存在过的数据。可以用时间或者SCN来返回之前提交过的数据。
  
  SELECT * FROM employees
  AS OF TIMESTAMP
  TO_TIMESTAMP('2004-04-04 09:30:00', 'YYYY-MM-DD HH:MI:SS')
  WHERE last_name = 'Chung';
  
  --插入数据
  INSERT INTO employees (
  SELECT * FROM employees
  AS OF TIMESTAMP
  TO_TIMESTAMP('2004-04-04 09:30:00', 'YYYY-MM-DD HH:MI:SS')
  WHERE last_name = 'Chung'
  );
  
  


RMAN：
 数据库必须是归档模式才可以备份。否则有可能遇到ORA-19602错误。
 
 archive log list;--查看归档模式
 select name,log_mode,open_mode from v$database; --查看 实例名，归档模式，启动模式。
 
 怎样启动到归档模式:
  1.shutdown immediate
  2.starup mount
  3.alter database archivelog;
  4.alter database open;
  
 关闭归档模式：
  1.shutdown immediate
  2.starup mount
  3.alter database noarchivelog;
  4.alter database open
 
 rman target / --连接本地数据库
 rman target sys/channel.. --连接远程数据库
 rman target / log f:\oracle\logs\rman_log.txt --指定日志文件存放地方，不然就显示到屏幕。
 
 rman备份的类型：
  1.镜像复制(物理备份)
    复制数据文件，控制文件，跟操作系统备份一样。
  2.备份集(逻辑备份)
    2.1单个备份
      rman> backup database; --被保存到Oracle软件的安装目录下。
      rman> backup database format 'e:\oracle\backup\bak_%U'; --必须要有这个目录，否则报错。
      rman> backup tablespace users; --表空间的备份
      
      sql> select file_id,file_name form dba_data_files;--查看数据文件的名称
      rman> backup datafile 'f:oracle\oradata\jssbook\user01.dbf'; --备份数据文件时可以指定数据文件名，也可以指定文件id
      rmna> backup datafile 1;--指定数据文件id
      rman> backup current controlfile; --备份控制文件
      
      在备份任意文件时都可以顺便备份控制文件：
      rman> backup database include current contorlfile;
      当将configure controlfile autobackup on 时，无论备份什么都会备份控制文件。
      
      归档文件的备份：
      rman> backup archivelog all;
      备份初始化参数文件：
      rman> backup spfile;--通常在备份控制文件的时候，会顺带备份参数文件。
      
      备份备份集：
      rman> backup backupset n/all;
      
      
      
      rman> delete backupset 10; --删除某个备份集，10是list backup of database的BPkey。
2.2批处理
      RUN{....}
      将run里的命令作为一个整体，只要一个失败就停止执行。  
    
查看已经创建的备份：
 list backup of database;
 list backup of tablespace users;
 
